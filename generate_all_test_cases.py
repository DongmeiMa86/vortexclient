# generate_all_test_cases.py
import pandas as pd
import itertools

def generate_all_test_cases():
    """ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æµ‹è¯•ç”¨ä¾‹ç»„åˆ"""
    
    # å®šä¹‰æ‰€æœ‰å‚æ•°é€‰é¡¹
    parameters = {
        "è¾“å‡ºæ ¼å¼": ["pts", "e57", "las"],
        "ç‚¹äº‘æŠ½ç¨€": ["å¯ç”¨", "ä¸å¯ç”¨"],
        "ä½“ç´ æŠ½ç¨€": ["å¯ç”¨", ""],  # ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºä¸å¯ç”¨
        "éšæœºæŠ½ç¨€": ["å¯ç”¨", ""],  # ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºä¸å¯ç”¨
        "è¾“å‡ºç±»å‹": ["å•ç«™", "åˆå¹¶", "å•ç«™+åˆå¹¶"],
        "è´´å›¾é€‰æ‹©": ["å½©å›¾", "åå°„ç‡", "åå°„ç‡+å½©å›¾"],
        "ç‚¹äº‘é™å™ª": ["å¯ç”¨", "ä¸å¯ç”¨"],
        "ç‚¹äº‘åšåº¦ä¼˜åŒ–": ["å¯ç”¨", "ä¸å¯ç”¨"]
    }
    
    # ç”Ÿæˆæ‰€æœ‰ç»„åˆ
    test_cases = []
    case_id = 1
    
    # éå†æ‰€æœ‰å‚æ•°ç»„åˆ
    for output_format in parameters["è¾“å‡ºæ ¼å¼"]:
        for thinning_enabled in parameters["ç‚¹äº‘æŠ½ç¨€"]:
            for output_type in parameters["è¾“å‡ºç±»å‹"]:
                for texture in parameters["è´´å›¾é€‰æ‹©"]:
                    for denoise in parameters["ç‚¹äº‘é™å™ª"]:
                        for thickness in parameters["ç‚¹äº‘åšåº¦ä¼˜åŒ–"]:
                            
                            if thinning_enabled == "å¯ç”¨":
                                # å¯ç”¨ç‚¹äº‘æŠ½ç¨€æ—¶ï¼Œæœ‰3ç§æŠ½ç¨€ç»„åˆ
                                thinning_combinations = [
                                    {"ä½“ç´ æŠ½ç¨€": "å¯ç”¨", "éšæœºæŠ½ç¨€": ""},  # åªå¯ç”¨ä½“ç´ æŠ½ç¨€
                                    {"ä½“ç´ æŠ½ç¨€": "", "éšæœºæŠ½ç¨€": "å¯ç”¨"},  # åªå¯ç”¨éšæœºæŠ½ç¨€
                                    {"ä½“ç´ æŠ½ç¨€": "å¯ç”¨", "éšæœºæŠ½ç¨€": "å¯ç”¨"},  # åŒæ—¶å¯ç”¨ä¸¤ç§æŠ½ç¨€
                                ]
                                
                                for thinning_combo in thinning_combinations:
                                    test_case = {
                                        "ç”¨ä¾‹ID": f"TC{case_id:04d}",
                                        "è¾“å‡ºæ ¼å¼": output_format,
                                        "ç‚¹äº‘æŠ½ç¨€": thinning_enabled,
                                        "ä½“ç´ æŠ½ç¨€": thinning_combo["ä½“ç´ æŠ½ç¨€"],
                                        "éšæœºæŠ½ç¨€": thinning_combo["éšæœºæŠ½ç¨€"],
                                        "è¾“å‡ºç±»å‹": output_type,
                                        "è´´å›¾é€‰æ‹©": texture,
                                        "ç‚¹äº‘é™å™ª": denoise,
                                        "ç‚¹äº‘åšåº¦ä¼˜åŒ–": thickness,
                                        "é¢„æœŸç»“æœ": "æˆåŠŸ",
                                        "å¤‡æ³¨": f"ç»„åˆ{case_id}"
                                    }
                                    test_cases.append(test_case)
                                    case_id += 1
                            else:
                                # ä¸å¯ç”¨ç‚¹äº‘æŠ½ç¨€æ—¶ï¼ŒæŠ½ç¨€æ–¹å¼ä¸ºç©º
                                test_case = {
                                    "ç”¨ä¾‹ID": f"TC{case_id:04d}",
                                    "è¾“å‡ºæ ¼å¼": output_format,
                                    "ç‚¹äº‘æŠ½ç¨€": thinning_enabled,
                                    "ä½“ç´ æŠ½ç¨€": "",
                                    "éšæœºæŠ½ç¨€": "",
                                    "è¾“å‡ºç±»å‹": output_type,
                                    "è´´å›¾é€‰æ‹©": texture,
                                    "ç‚¹äº‘é™å™ª": denoise,
                                    "ç‚¹äº‘åšåº¦ä¼˜åŒ–": thickness,
                                    "é¢„æœŸç»“æœ": "æˆåŠŸ",
                                    "å¤‡æ³¨": f"ç»„åˆ{case_id}"
                                }
                                test_cases.append(test_case)
                                case_id += 1
    
    # ä¿å­˜åˆ°CSV
    df = pd.DataFrame(test_cases)
    output_file = "test_cases/all_test_cases_complete.csv"
    df.to_csv(output_file, index=False, encoding='utf-8')
    
    # è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
    total_cases = len(test_cases)
    
    print("="*60)
    print("âœ… æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå®Œæˆï¼")
    print(f"æ€»æµ‹è¯•ç”¨ä¾‹æ•°: {total_cases}")
    
    # ç»Ÿè®¡å„ç±»é…ç½®æ•°é‡
    stats = {
        "è¾“å‡ºæ ¼å¼": {"pts": 0, "e57": 0, "las": 0},
        "ç‚¹äº‘æŠ½ç¨€": {"å¯ç”¨": 0, "ä¸å¯ç”¨": 0},
        "æŠ½ç¨€ç»„åˆ": {
            "åªå¯ç”¨ä½“ç´ æŠ½ç¨€": 0,
            "åªå¯ç”¨éšæœºæŠ½ç¨€": 0,
            "åŒæ—¶å¯ç”¨ä¸¤ç§æŠ½ç¨€": 0,
            "ä¸å¯ç”¨æŠ½ç¨€": 0
        }
    }
    
    for test_case in test_cases:
        # ç»Ÿè®¡è¾“å‡ºæ ¼å¼
        stats["è¾“å‡ºæ ¼å¼"][test_case["è¾“å‡ºæ ¼å¼"]] += 1
        
        # ç»Ÿè®¡ç‚¹äº‘æŠ½ç¨€
        stats["ç‚¹äº‘æŠ½ç¨€"][test_case["ç‚¹äº‘æŠ½ç¨€"]] += 1
        
        # ç»Ÿè®¡æŠ½ç¨€ç»„åˆ
        if test_case["ç‚¹äº‘æŠ½ç¨€"] == "å¯ç”¨":
            if test_case["ä½“ç´ æŠ½ç¨€"] == "å¯ç”¨" and test_case["éšæœºæŠ½ç¨€"] == "":
                stats["æŠ½ç¨€ç»„åˆ"]["åªå¯ç”¨ä½“ç´ æŠ½ç¨€"] += 1
            elif test_case["ä½“ç´ æŠ½ç¨€"] == "" and test_case["éšæœºæŠ½ç¨€"] == "å¯ç”¨":
                stats["æŠ½ç¨€ç»„åˆ"]["åªå¯ç”¨éšæœºæŠ½ç¨€"] += 1
            elif test_case["ä½“ç´ æŠ½ç¨€"] == "å¯ç”¨" and test_case["éšæœºæŠ½ç¨€"] == "å¯ç”¨":
                stats["æŠ½ç¨€ç»„åˆ"]["åŒæ—¶å¯ç”¨ä¸¤ç§æŠ½ç¨€"] += 1
        else:
            stats["æŠ½ç¨€ç»„åˆ"]["ä¸å¯ç”¨æŠ½ç¨€"] += 1
    
    print("\nğŸ“Š é…ç½®ç»Ÿè®¡:")
    print(f"  è¾“å‡ºæ ¼å¼: pts={stats['è¾“å‡ºæ ¼å¼']['pts']}, e57={stats['è¾“å‡ºæ ¼å¼']['e57']}, las={stats['è¾“å‡ºæ ¼å¼']['las']}")
    print(f"  ç‚¹äº‘æŠ½ç¨€: å¯ç”¨={stats['ç‚¹äº‘æŠ½ç¨€']['å¯ç”¨']}, ä¸å¯ç”¨={stats['ç‚¹äº‘æŠ½ç¨€']['ä¸å¯ç”¨']}")
    print(f"  æŠ½ç¨€ç»„åˆ:")
    print(f"    åªå¯ç”¨ä½“ç´ æŠ½ç¨€: {stats['æŠ½ç¨€ç»„åˆ']['åªå¯ç”¨ä½“ç´ æŠ½ç¨€']}")
    print(f"    åªå¯ç”¨éšæœºæŠ½ç¨€: {stats['æŠ½ç¨€ç»„åˆ']['åªå¯ç”¨éšæœºæŠ½ç¨€']}")
    print(f"    åŒæ—¶å¯ç”¨ä¸¤ç§æŠ½ç¨€: {stats['æŠ½ç¨€ç»„åˆ']['åŒæ—¶å¯ç”¨ä¸¤ç§æŠ½ç¨€']}")
    print(f"    ä¸å¯ç”¨æŠ½ç¨€: {stats['æŠ½ç¨€ç»„åˆ']['ä¸å¯ç”¨æŠ½ç¨€']}")
    
    print(f"\nğŸ“ å·²ä¿å­˜åˆ°: {output_file}")
    
    return test_cases

if __name__ == "__main__":
    generate_all_test_cases()